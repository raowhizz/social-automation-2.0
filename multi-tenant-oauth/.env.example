# ===================================
# SOCIAL AUTOMATION - MULTI-TENANT OAUTH
# Environment Variables Configuration
# ===================================
#
# This is an example configuration file. Copy this file to .env and update
# with your actual values. Never commit .env to version control!
#
# Quick Setup:
#   cp .env.example .env
#   nano .env  # Edit with your values
#

# ===================================
# DATABASE CONFIGURATION
# ===================================

# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://localhost/social_automation_multi_tenant

# For Docker deployment:
# DATABASE_URL=postgresql://postgres:postgres@postgres:5432/social_automation_multi_tenant

# ===================================
# REDIS CONFIGURATION
# ===================================

# Redis connection string for caching and Celery task queue
REDIS_URL=redis://localhost:6379/0

# For Docker deployment:
# REDIS_URL=redis://redis:6379/0

# ===================================
# APPLICATION SECURITY
# ===================================

# Secret key for JWT tokens and session management
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your-secret-key-here-replace-me

# Encryption key for OAuth tokens (AES-256-GCM)
# Must be 32 bytes, base64-encoded
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
ENCRYPTION_KEY=your-encryption-key-here-replace-me

# ===================================
# FACEBOOK OAUTH CONFIGURATION
# ===================================

# Get these from: https://developers.facebook.com/apps
# Create a Facebook App and copy the credentials below

# Facebook App ID (from App Dashboard > Settings > Basic)
FACEBOOK_APP_ID=your-facebook-app-id

# Facebook App Secret (from App Dashboard > Settings > Basic)
FACEBOOK_APP_SECRET=your-facebook-app-secret

# OAuth Redirect URIs
# Must match exactly with what's configured in Facebook App settings
# For local development:
FACEBOOK_REDIRECT_URI=http://localhost:8000/api/v1/oauth/facebook/callback
INSTAGRAM_REDIRECT_URI=http://localhost:8000/oauth/instagram/callback

# For production, update with your domain:
# FACEBOOK_REDIRECT_URI=https://yourdomain.com/api/v1/oauth/facebook/callback
# INSTAGRAM_REDIRECT_URI=https://yourdomain.com/oauth/instagram/callback

# Facebook Graph API Version (current: v18.0)
FACEBOOK_GRAPH_API_VERSION=v18.0

# Facebook OAuth Scopes (permissions requested from users)
# Scopes for Facebook Pages posting
FACEBOOK_OAUTH_SCOPES=pages_show_list,pages_read_engagement,pages_manage_posts,pages_read_user_content

# Instagram OAuth Scopes (permissions for Instagram Business)
INSTAGRAM_OAUTH_SCOPES=instagram_basic,instagram_content_publish,instagram_manage_comments,instagram_manage_insights

# ===================================
# OPENAI CONFIGURATION
# ===================================

# OpenAI API Key for AI-powered content generation
# Get from: https://platform.openai.com/api-keys
# Leave empty to use template-based captions (no AI)
OPENAI_API_KEY=

# OpenAI Model Configuration
# See available models: https://platform.openai.com/docs/models
GPT_TEXT_MODEL=gpt-4
GPT_REASONING_MODEL=gpt-4-turbo
GPT_VISION_MODEL=gpt-4-vision-preview
GPT_IMAGE_GENERATION_MODEL=dall-e-3
GPT_IMAGE_EDIT_MODEL=dall-e-2
GPT_EMBEDDINGS_MODEL=text-embedding-3-large
GPT_TRANSCRIPTION_MODEL=whisper-1
GPT_TTS_MODEL=tts-1

# ===================================
# APPLICATION URLS
# ===================================

# Backend API URL
# Development (local):
API_URL=http://localhost:8000

# Development (with ngrok for Facebook image access):
# Get ngrok URL from: ngrok http 8000
# API_URL=https://your-ngrok-url.ngrok-free.dev

# Production (your domain):
# API_URL=https://api.yourdomain.com

# Frontend URL (for CORS configuration)
APP_URL=http://localhost:3000

# Public URL for OAuth callbacks and external access
# Must match FACEBOOK_REDIRECT_URI domain
PUBLIC_URL=http://localhost:8000

# Production:
# PUBLIC_URL=https://yourdomain.com

# ===================================
# CELERY CONFIGURATION
# ===================================

# Celery broker (task queue)
CELERY_BROKER_URL=redis://localhost:6379/0

# Celery result backend (task results storage)
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# For Docker:
# CELERY_BROKER_URL=redis://redis:6379/0
# CELERY_RESULT_BACKEND=redis://redis:6379/0

# Celery Beat Schedule
# How often to refresh expiring tokens (in hours)
TOKEN_REFRESH_INTERVAL=24

# How often to cleanup expired OAuth states (in hours)
STATE_CLEANUP_INTERVAL=1

# ===================================
# TOKEN MANAGEMENT
# ===================================

# Refresh tokens this many days before expiration
# Recommended: 7 days for safety margin
TOKEN_REFRESH_THRESHOLD_DAYS=7

# OAuth state token expiration (in minutes)
# Recommended: 10 minutes for security
OAUTH_STATE_EXPIRATION_MINUTES=10

# Access token cache TTL (in seconds)
# How long to cache decrypted tokens in Redis
TOKEN_CACHE_TTL=300

# ===================================
# RATE LIMITING
# ===================================

# API rate limits per plan (requests per hour)
RATE_LIMIT_BASIC=100
RATE_LIMIT_PRO=500
RATE_LIMIT_ENTERPRISE=2000

# Posting limits per plan (posts per day)
POST_LIMIT_BASIC=10
POST_LIMIT_PRO=50
POST_LIMIT_ENTERPRISE=200

# ===================================
# LOGGING
# ===================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Use DEBUG for development, INFO for production
LOG_LEVEL=INFO

# ===================================
# CORS CONFIGURATION
# ===================================

# Allowed origins for CORS (comma-separated)
# Add your frontend URLs here
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# Production example:
# CORS_ORIGINS=https://yourdomain.com,https://app.yourdomain.com

# ===================================
# EMAIL CONFIGURATION (Optional)
# ===================================

# SMTP settings for sending alert emails
# Leave empty if not using email alerts

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@social-automation.com

# For Gmail:
# 1. Enable 2-factor authentication
# 2. Generate App Password: https://myaccount.google.com/apppasswords
# 3. Use App Password in SMTP_PASSWORD

# ===================================
# MONITORING & ALERTS (Optional)
# ===================================

# Sentry DSN for error tracking
# Get from: https://sentry.io/
SENTRY_DSN=

# Sentry environment (development, staging, production)
SENTRY_ENVIRONMENT=development

# ===================================
# AWS S3 CONFIGURATION (Production)
# ===================================

# AWS credentials for S3 image storage
# Only needed for production deployment
# Leave empty for development (uses local storage + ngrok)

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET=
AWS_S3_REGION=us-east-1

# When using S3, update API_URL:
# API_URL=https://your-bucket.s3.amazonaws.com
# Or use CloudFront CDN:
# API_URL=https://your-cloudfront-domain.cloudfront.net

# ===================================
# DEVELOPMENT FLAGS
# ===================================

# Enable debug mode (detailed error messages, auto-reload)
# WARNING: Set to False in production!
DEBUG=True

# Enable auto-reload on code changes
# Only for development
RELOAD=True

# ===================================
# PRODUCTION SETTINGS
# ===================================

# When deploying to production, update these:
# 
# 1. Security:
#    - DEBUG=False
#    - Generate strong SECRET_KEY and ENCRYPTION_KEY
#    - Use HTTPS for all URLs
#
# 2. Database:
#    - Use managed PostgreSQL (AWS RDS, etc.)
#    - Enable SSL connections
#    - Set up automated backups
#
# 3. Redis:
#    - Use managed Redis (AWS ElastiCache, etc.)
#    - Enable persistence
#
# 4. OAuth:
#    - Update FACEBOOK_REDIRECT_URI with production domain
#    - Complete Facebook App Review for public access
#
# 5. Image Storage:
#    - Configure AWS S3 (replace ngrok)
#    - Set up CloudFront CDN
#
# 6. Monitoring:
#    - Configure Sentry for error tracking
#    - Set up email alerts
#    - Configure log aggregation
#
# 7. CORS:
#    - Update CORS_ORIGINS with production frontend URL
#
# 8. Rate Limits:
#    - Adjust limits based on expected traffic
#
# ===================================
# QUICK REFERENCE
# ===================================
#
# Generate SECRET_KEY:
#   python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# Generate ENCRYPTION_KEY:
#   python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# Test database connection:
#   psql $DATABASE_URL
#
# Test Redis connection:
#   redis-cli -u $REDIS_URL ping
#
# Start development server:
#   uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
#
# Start Celery worker:
#   celery -A app.tasks.celery_app worker --loglevel=info
#
# Start Celery beat:
#   celery -A app.tasks.celery_app beat --loglevel=info
#
